generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model Movie {
  id String @id @default(uuid())

  title       String
  description String?
  releaseYear Int     @map("release_year")

  rating Decimal @default(0.0) @db.Decimal(3, 1)

  genre Genre @default(DRAMA)

  reviews Review[] @relation("movie_reviews")
  actors  Actor[]  @relation("movies_actors")

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")
  poster    Poster?  @relation("movie_poster")

  @@map("movies")
}

model Review {
  id String @id @default(uuid())

  text   String
  rating Decimal @default(0.0) @db.Decimal(3, 1)

  movie   Movie  @relation(fields: [movieId], references: [id], onDelete: Cascade, "movie_reviews")
  movieId String

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  @@map("reviews")
}

model Actor {
  id String @id @default(uuid())

  name String

  movies Movie[] @relation("movies_actors")

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  @@map("actors")
}

model Poster {
  id String @id @default(uuid())

  url String

  movie   Movie  @relation("movie_poster", fields: [movieId], references: [id], onDelete: Cascade)
  movieId String @unique

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  @@map("posters")
}

model Message {
  id String @id @default(uuid())

  text String

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  @@map("messages")
}

model Phone {
  id String @id @default(uuid())

  price Int
  brand String

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  @@map("phones")
}

enum Genre {
  DRAMA
  COMEDY
}
